Sub ExtractColumns()
    ' Create a variable for the user to fill out for the name of a header
    Dim headerName As String
    headerName = InputBox("Enter the name of the header:")

    ' Create a list of column indices; the user should be able to specify which specific columns to extract
    Dim columnIndices As Variant
    columnIndices = Split(InputBox("Enter the column indices to extract, separated by commas:"), ",")

    ' Create a list of Excel sheet names; the user should be able to write in the name of sheet names
    Dim sheetNames As Variant
    sheetNames = Split(InputBox("Enter the sheet names, separated by commas:"), ",")

    ' Create a loop that goes through the list of indices and sheet names:
    Dim i As Long, j As Long
    For i = LBound(sheetNames) To UBound(sheetNames)
        For j = LBound(columnIndices) To UBound(columnIndices)
            ' Ignore the first row of the currently opened Excel file; the first row contains headers
            Dim currentSheet As Worksheet
            Set currentSheet = ThisWorkbook.Sheets(sheetNames(i))

            ' Extract a column
            Dim lastRow As Long
            lastRow = currentSheet.Cells(currentSheet.Rows.Count, columnIndices(j)).End(xlUp).Row

            Dim extractedColumn As Range
            Set extractedColumn = currentSheet.Range(currentSheet.Cells(2, columnIndices(j)), currentSheet.Cells(lastRow, columnIndices(j)))

            ' The extracted column should be concatenated to the end of each sheet; the user should be able to specify the directory of the Excel file that contains the sheet name from the list of sheet names
            Dim targetWorkbookPath As String
            targetWorkbookPath = InputBox("Enter the path of the target workbook:")

            Dim targetWorkbook As Workbook
            Set targetWorkbook = Workbooks.Open(targetWorkbookPath)

            Dim targetSheet As Worksheet
            Set targetSheet = targetWorkbook.Sheets(sheetNames(i))

            Dim targetLastRow As Long
            targetLastRow = targetSheet.Cells(targetSheet.Rows.Count, 1).End(xlUp).Row

            extractedColumn.Copy Destination:=targetSheet.Range("A" & targetLastRow + 1)
        Next j
    Next i
End Sub
