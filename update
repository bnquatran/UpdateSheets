Sub ExtractColumns()
    ' Define the path of the target workbook
    Dim targetWorkbookPath As String
    targetWorkbookPath = "C:\Path\To\Target\Workbook.xlsx"

    ' Define the name of the header
    Dim headerName As String
    headerName = "Header Name"

    ' Define the list of column indices to extract
    Dim columnIndices As Variant
    columnIndices = Array(1, 2, 3)

    ' Define the list of sheet names
    Dim sheetNames As Variant
    sheetNames = Array("Sheet1", "Sheet2", "Sheet3")

    ' Create a loop that goes through the list of indices and sheet names at the same time:
    Dim i As Long
    For i = LBound(sheetNames) To UBound(sheetNames)
        ' Ignore the first row of the currently opened Excel file; the first row contains headers
        Dim currentSheet As Worksheet
        Set currentSheet = ThisWorkbook.Sheets(sheetNames(i))

        ' Extract a column
        Dim lastRow As Long
        lastRow = currentSheet.Cells(currentSheet.Rows.Count, columnIndices(i)).End(xlUp).Row

        Dim extractedColumn As Range
        Set extractedColumn = currentSheet.Range(currentSheet.Cells(2, columnIndices(i)), currentSheet.Cells(lastRow, columnIndices(i)))

        ' The extracted column should be concatenated after the last column of each sheet; the user should be able to specify the directory of the Excel file that contains the sheet name from the list of sheet names
        Dim targetWorkbook As Workbook
        Set targetWorkbook = Workbooks.Open(targetWorkbookPath)

        Dim targetSheet As Worksheet
        Set targetSheet = targetWorkbook.Sheets(sheetNames(i))

        Dim targetLastColumn As Long
        targetLastColumn = targetSheet.Cells(1, targetSheet.Columns.Count).End(xlToLeft).Column

        extractedColumn.Copy Destination:=targetSheet.Cells(1, targetLastColumn + 1)
    Next i
End Sub
